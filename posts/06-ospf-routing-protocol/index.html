<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>OSPF Routing Protocol: Dynamic Routing trong doanh nghiệp | NetCode Blog - Đào Văn Thắng</title>
    <meta name="description" content="Blog chia sẻ kiến thức về Lập trình Mạng Máy tính và JavaScript">
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800;900&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f9fafb;
        }
    </style>
</head>
<body>
    <h1>NetCode Blog - Đào Văn Thắng</h1>

  <nav>
    <ul>
    <li>
      <a href="/">Trang chủ</a>
    </li>
    <li>
      <a href="/posts/">Bài viết</a>
    </li>
    <li>
      <a href="/about/">Giới thiệu</a>
    </li>
    <li>
      <a href="/certificates/">Chứng chỉ</a>
    </li>
    <li>
      <a href="/contact/">Liên hệ</a>
    </li>
    </ul>
  </nav>


    
    <main>
        
  <h1>OSPF Routing Protocol: Dynamic Routing trong doanh nghiệp</h1>

  
  
  <time datetime="2023-11-08T00:00:00&#43;00:00">November 8, 2023</time>

  <h2 id="giới-thiệu-ospf">Giới thiệu OSPF</h2>
<p><strong>OSPF (Open Shortest Path First)</strong> là link-state routing protocol được sử dụng rộng rãi trong doanh nghiệp.</p>
<h3 id="đặc-điểm-chính">Đặc điểm chính</h3>
<ul>
<li><strong>Standard</strong>: RFC 2328 (OSPFv2), RFC 5340 (OSPFv3)</li>
<li><strong>Metric</strong>: Cost (dựa trên bandwidth)</li>
<li><strong>Algorithm</strong>: Dijkstra&rsquo;s Shortest Path First (SPF)</li>
<li><strong>Administrative Distance</strong>: 110</li>
<li><strong>Protocol Number</strong>: 89 (không dùng TCP/UDP)</li>
<li><strong>Multicast</strong>: 224.0.0.5 (All OSPF Routers), 224.0.0.6 (DR/BDR)</li>
</ul>
<h3 id="so-sánh-với-rip">So sánh với RIP</h3>
<table>
  <thead>
      <tr>
          <th>Feature</th>
          <th>RIP</th>
          <th>OSPF</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>Type</td>
          <td>Distance Vector</td>
          <td>Link State</td>
      </tr>
      <tr>
          <td>Metric</td>
          <td>Hop Count (max 15)</td>
          <td>Cost (bandwidth)</td>
      </tr>
      <tr>
          <td>Convergence</td>
          <td>Slow</td>
          <td>Fast</td>
      </tr>
      <tr>
          <td>Scalability</td>
          <td>Small networks</td>
          <td>Large networks</td>
      </tr>
      <tr>
          <td>VLSM Support</td>
          <td>RIPv2: Yes</td>
          <td>Yes</td>
      </tr>
      <tr>
          <td>Updates</td>
          <td>Full table every 30s</td>
          <td>Triggered updates</td>
      </tr>
      <tr>
          <td>Algorithm</td>
          <td>Bellman-Ford</td>
          <td>Dijkstra SPF</td>
      </tr>
  </tbody>
</table>
<h2 id="ospf-hoạt-động-như-thế-nào">OSPF Hoạt động như thế nào?</h2>
<h3 id="1-neighbor-discovery">1. Neighbor Discovery</h3>
<p>Routers tìm neighbors bằng <strong>Hello packets</strong> (mỗi 10s trên broadcast networks).</p>
<pre tabindex="0"><code>Hello Packet contains:
- Router ID
- Hello/Dead intervals
- Area ID
- Network Mask
- Authentication
- Neighbors list
</code></pre><h3 id="2-database-synchronization">2. Database Synchronization</h3>
<p>Routers trao đổi <strong>LSAs (Link-State Advertisements)</strong> để xây dựng <strong>LSDB (Link-State Database)</strong> giống nhau.</p>
<h3 id="3-spf-calculation">3. SPF Calculation</h3>
<p>Mỗi router chạy Dijkstra algorithm trên LSDB để tính:</p>
<ul>
<li><strong>Shortest path</strong> đến mọi destination</li>
<li>Xây dựng <strong>routing table</strong></li>
</ul>
<h3 id="4-route-installation">4. Route Installation</h3>
<p>Best routes được cài vào routing table.</p>
<h2 id="ospf-areas">OSPF Areas</h2>
<p>OSPF sử dụng <strong>hierarchical design</strong> với Areas để scale.</p>
<pre tabindex="0"><code>        [Area 0 - Backbone]
               |
    +----------+----------+
    |          |          |
[Area 1]   [Area 2]   [Area 3]
</code></pre><h3 id="loại-areas">Loại Areas</h3>
<table>
  <thead>
      <tr>
          <th>Area Type</th>
          <th>Description</th>
          <th>LSAs Allowed</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td><strong>Backbone (Area 0)</strong></td>
          <td>Core area, all others connect to it</td>
          <td>All types</td>
      </tr>
      <tr>
          <td><strong>Standard Area</strong></td>
          <td>Can receive all LSA types</td>
          <td>All types</td>
      </tr>
      <tr>
          <td><strong>Stub Area</strong></td>
          <td>No external routes (Type 5 LSA)</td>
          <td>1, 2, 3</td>
      </tr>
      <tr>
          <td><strong>Totally Stubby</strong></td>
          <td>Only default route from ABR</td>
          <td>1, 2</td>
      </tr>
      <tr>
          <td><strong>NSSA</strong></td>
          <td>Stub with external routes converted</td>
          <td>1, 2, 3, 7</td>
      </tr>
  </tbody>
</table>
<h3 id="router-types">Router Types</h3>
<ol>
<li><strong>Internal Router (IR)</strong>: Tất cả interfaces trong cùng 1 area</li>
<li><strong>Backbone Router (BR)</strong>: Có interface trong Area 0</li>
<li><strong>Area Border Router (ABR)</strong>: Kết nối nhiều areas</li>
<li><strong>Autonomous System Boundary Router (ASBR)</strong>: Redistribute routes từ external sources</li>
</ol>
<h2 id="ospf-metric---cost">OSPF Metric - Cost</h2>
<h3 id="công-thức-cost">Công thức Cost</h3>
<pre tabindex="0"><code>Cost = Reference Bandwidth / Interface Bandwidth

Default Reference Bandwidth = 100 Mbps

Examples:
- FastEthernet (100 Mbps): 100/100 = 1
- GigabitEthernet (1000 Mbps): 100/1000 = 1 (!)
- 10GigE (10000 Mbps): 100/10000 = 1 (!)
</code></pre><p>⚠️ <strong>Problem</strong>: Tất cả interfaces ≥ 100Mbps đều có cost = 1!</p>
<h3 id="solution-thay-đổi-reference-bandwidth">Solution: Thay đổi Reference Bandwidth</h3>
<pre tabindex="0"><code>Router(config-router)# auto-cost reference-bandwidth 10000
</code></pre><p>Giờ:</p>
<ul>
<li>FastEthernet: 10000/100 = 100</li>
<li>GigabitEthernet: 10000/1000 = 10</li>
<li>10GigE: 10000/10000 = 1</li>
</ul>
<h2 id="cấu-hình-ospf-cơ-bản">Cấu hình OSPF cơ bản</h2>
<h3 id="topology-ví-dụ">Topology ví dụ</h3>
<pre tabindex="0"><code>        10.1.1.0/30
R1 -------------------- R2
.1  Gi0/0      Gi0/0  .2
   |                    |
   | 192.168.1.0/24     | 192.168.2.0/24
   |                    |
  LAN1                 LAN2
</code></pre><h3 id="cấu-hình-r1">Cấu hình R1</h3>
<pre tabindex="0"><code>R1(config)# router ospf 1
R1(config-router)# router-id 1.1.1.1
R1(config-router)# network 192.168.1.0 0.0.0.255 area 0
R1(config-router)# network 10.1.1.0 0.0.0.3 area 0
R1(config-router)# passive-interface GigabitEthernet0/1
</code></pre><p><strong>Giải thích:</strong></p>
<ul>
<li><code>router ospf 1</code>: Process ID (local significance)</li>
<li><code>router-id</code>: Unique identifier (dùng IP nếu không config)</li>
<li><code>network</code>: Advertise networks vào OSPF</li>
<li><code>passive-interface</code>: Không gửi Hello packets (LAN side)</li>
</ul>
<h3 id="cấu-hình-r2">Cấu hình R2</h3>
<pre tabindex="0"><code>R2(config)# router ospf 1
R2(config-router)# router-id 2.2.2.2
R2(config-router)# network 192.168.2.0 0.0.0.255 area 0
R2(config-router)# network 10.1.1.0 0.0.0.3 area 0
R2(config-router)# passive-interface GigabitEthernet0/1
</code></pre><h3 id="verify-configuration">Verify Configuration</h3>
<pre tabindex="0"><code>R1# show ip ospf neighbor

Neighbor ID     Pri   State           Dead Time   Address         Interface
2.2.2.2         1     FULL/  -        00:00:35    10.1.1.2        Gi0/0
</code></pre><pre tabindex="0"><code>R1# show ip route ospf

O    192.168.2.0/24 [110/2] via 10.1.1.2, 00:05:23, GigabitEthernet0/0
</code></pre><h2 id="multi-area-ospf">Multi-Area OSPF</h2>
<h3 id="topology-phức-tạp">Topology phức tạp</h3>
<pre tabindex="0"><code>         Area 0 (Backbone)
              |
    +---------+---------+
    |                   |
  Area 1             Area 2
  (Branch 1)       (Branch 2)
</code></pre><h3 id="cấu-hình-abr">Cấu hình ABR</h3>
<p>Router kết nối Area 0 và Area 1:</p>
<pre tabindex="0"><code>R-ABR(config)# router ospf 1
R-ABR(config-router)# router-id 10.0.0.1
R-ABR(config-router)# network 10.0.0.0 0.0.0.255 area 0
R-ABR(config-router)# network 192.168.10.0 0.0.0.255 area 1
</code></pre><h2 id="drbdr-election">DR/BDR Election</h2>
<p>Trên <strong>multi-access networks</strong> (Ethernet), OSPF bầu:</p>
<ul>
<li><strong>DR (Designated Router)</strong>: Trung tâm LSA exchange</li>
<li><strong>BDR (Backup DR)</strong>: Backup nếu DR fail</li>
</ul>
<h3 id="election-process">Election Process</h3>
<ol>
<li><strong>Highest Priority</strong> (0-255, default 1) wins</li>
<li>Nếu bằng nhau: <strong>Highest Router ID</strong></li>
<li>Priority 0 = không tham gia election</li>
</ol>
<h3 id="cấu-hình-priority">Cấu hình Priority</h3>
<pre tabindex="0"><code>R1(config)# interface GigabitEthernet0/0
R1(config-if)# ip ospf priority 100
</code></pre><h3 id="verify-drbdr">Verify DR/BDR</h3>
<pre tabindex="0"><code>R1# show ip ospf interface GigabitEthernet0/0

...
Designated Router (ID) 1.1.1.1, Interface address 10.1.1.1
Backup Designated router (ID) 2.2.2.2, Interface address 10.1.1.2
...
</code></pre><h2 id="ospf-authentication">OSPF Authentication</h2>
<p>Bảo mật OSPF bằng authentication.</p>
<h3 id="plain-text-authentication-không-khuyến-nghị">Plain Text Authentication (không khuyến nghị)</h3>
<pre tabindex="0"><code>R1(config)# interface GigabitEthernet0/0
R1(config-if)# ip ospf authentication
R1(config-if)# ip ospf authentication-key MyPassword123
</code></pre><h3 id="md5-authentication-khuyến-nghị">MD5 Authentication (khuyến nghị)</h3>
<pre tabindex="0"><code>R1(config)# interface GigabitEthernet0/0
R1(config-if)# ip ospf authentication message-digest
R1(config-if)# ip ospf message-digest-key 1 md5 SecurePass456
</code></pre><p><strong>Lưu ý:</strong> Tất cả routers trong cùng segment phải cùng key!</p>
<h2 id="tuning-ospf">Tuning OSPF</h2>
<h3 id="1-thay-đổi-hellodead-timers">1. Thay đổi Hello/Dead Timers</h3>
<pre tabindex="0"><code>R1(config-if)# ip ospf hello-interval 5
R1(config-if)# ip ospf dead-interval 20
</code></pre><p>Default: Hello 10s, Dead 40s (broadcast/p2p)</p>
<h3 id="2-thay-đổi-cost-manually">2. Thay đổi Cost manually</h3>
<pre tabindex="0"><code>R1(config-if)# ip ospf cost 50
</code></pre><h3 id="3-default-route-propagation">3. Default Route Propagation</h3>
<pre tabindex="0"><code>R-ASBR(config)# router ospf 1
R-ASBR(config-router)# default-information originate
</code></pre><p>Hoặc với route-map:</p>
<pre tabindex="0"><code>R-ASBR(config-router)# default-information originate always route-map CHECK-DEFAULT
</code></pre><h2 id="troubleshooting-ospf">Troubleshooting OSPF</h2>
<h3 id="common-issues">Common Issues</h3>
<ol>
<li>
<p><strong>Neighbors không lên FULL</strong></p>
<ul>
<li>Hello/Dead interval mismatch</li>
<li>Area ID mismatch</li>
<li>Authentication mismatch</li>
<li>Network type mismatch</li>
</ul>
</li>
<li>
<p><strong>Routes không xuất hiện</strong></p>
<ul>
<li>Wrong area configuration</li>
<li>Interface passive</li>
<li>ACL blocking OSPF</li>
</ul>
</li>
<li>
<p><strong>Routing loops</strong></p>
<ul>
<li>Incorrect cost configuration</li>
<li>Area design issues</li>
</ul>
</li>
</ol>
<h3 id="debug-commands">Debug Commands</h3>
<pre tabindex="0"><code>R1# show ip ospf neighbor
R1# show ip ospf interface brief
R1# show ip ospf database
R1# show ip route ospf
R1# show ip protocols

R1# debug ip ospf hello
R1# debug ip ospf adj
R1# debug ip ospf packet
</code></pre><h3 id="verify-ospf-operation">Verify OSPF Operation</h3>
<pre tabindex="0"><code>R1# show ip ospf

 Routing Process &#34;ospf 1&#34; with ID 1.1.1.1
 Start time: 00:00:05.123, Time elapsed: 00:15:32.456
 ...
 Number of areas in this router is 1. 1 normal 0 stub 0 nssa
 ...
</code></pre><pre tabindex="0"><code>R1# show ip ospf interface GigabitEthernet0/0

GigabitEthernet0/0 is up, line protocol is up 
  Internet Address 10.1.1.1/30, Area 0
  Process ID 1, Router ID 1.1.1.1, Network Type POINT_TO_POINT, Cost: 1
  Transmit Delay is 1 sec, State POINT_TO_POINT
  Timer intervals configured, Hello 10, Dead 40, Wait 40, Retransmit 5
  ...
</code></pre><h2 id="ospf-lsa-types">OSPF LSA Types</h2>
<table>
  <thead>
      <tr>
          <th>LSA Type</th>
          <th>Name</th>
          <th>Generated By</th>
          <th>Purpose</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>Type 1</td>
          <td>Router LSA</td>
          <td>All routers</td>
          <td>Router&rsquo;s directly connected links</td>
      </tr>
      <tr>
          <td>Type 2</td>
          <td>Network LSA</td>
          <td>DR</td>
          <td>Multi-access network info</td>
      </tr>
      <tr>
          <td>Type 3</td>
          <td>Summary LSA</td>
          <td>ABR</td>
          <td>Inter-area routes</td>
      </tr>
      <tr>
          <td>Type 4</td>
          <td>ASBR Summary</td>
          <td>ABR</td>
          <td>Location of ASBR</td>
      </tr>
      <tr>
          <td>Type 5</td>
          <td>External LSA</td>
          <td>ASBR</td>
          <td>External routes (redistributed)</td>
      </tr>
      <tr>
          <td>Type 7</td>
          <td>NSSA External</td>
          <td>ASBR (trong NSSA)</td>
          <td>External routes trong NSSA</td>
      </tr>
  </tbody>
</table>
<h2 id="lab-practice-ospf-configuration">Lab Practice: OSPF Configuration</h2>
<h3 id="topology">Topology</h3>
<pre tabindex="0"><code>                 Area 0
    R1 -------- R2 -------- R3
    |                        |
   LAN1                     LAN2
192.168.1.0/24         192.168.3.0/24
</code></pre><h3 id="step-by-step-configuration">Step-by-Step Configuration</h3>
<p><strong>1. R1 Configuration:</strong></p>
<pre tabindex="0"><code>R1(config)# interface Gi0/0
R1(config-if)# ip address 10.1.1.1 255.255.255.252
R1(config-if)# no shutdown

R1(config)# interface Gi0/1
R1(config-if)# ip address 192.168.1.1 255.255.255.0
R1(config-if)# no shutdown

R1(config)# router ospf 1
R1(config-router)# router-id 1.1.1.1
R1(config-router)# network 10.1.1.0 0.0.0.3 area 0
R1(config-router)# network 192.168.1.0 0.0.0.255 area 0
R1(config-router)# passive-interface Gi0/1
</code></pre><p><strong>2. R2 Configuration:</strong></p>
<pre tabindex="0"><code>R2(config)# interface Gi0/0
R2(config-if)# ip address 10.1.1.2 255.255.255.252
R2(config-if)# no shutdown

R2(config)# interface Gi0/1
R2(config-if)# ip address 10.1.2.1 255.255.255.252
R2(config-if)# no shutdown

R2(config)# router ospf 1
R2(config-router)# router-id 2.2.2.2
R2(config-router)# network 10.1.1.0 0.0.0.3 area 0
R2(config-router)# network 10.1.2.0 0.0.0.3 area 0
</code></pre><p><strong>3. R3 Configuration:</strong></p>
<pre tabindex="0"><code>R3(config)# interface Gi0/0
R3(config-if)# ip address 10.1.2.2 255.255.255.252
R3(config-if)# no shutdown

R3(config)# interface Gi0/1
R3(config-if)# ip address 192.168.3.1 255.255.255.0
R3(config-if)# no shutdown

R3(config)# router ospf 1
R3(config-router)# router-id 3.3.3.3
R3(config-router)# network 10.1.2.0 0.0.0.3 area 0
R3(config-router)# network 192.168.3.0 0.0.0.255 area 0
R3(config-router)# passive-interface Gi0/1
</code></pre><p><strong>4. Verification:</strong></p>
<pre tabindex="0"><code>R1# ping 192.168.3.1
R1# show ip route ospf
R1# show ip ospf neighbor
</code></pre><h2 id="best-practices">Best Practices</h2>
<ol>
<li><strong>Always use Area 0</strong> as backbone</li>
<li><strong>Configure Router IDs</strong> manually (dùng Loopback)</li>
<li><strong>Use passive-interface</strong> cho LAN segments</li>
<li><strong>Tune reference-bandwidth</strong> cho modern networks</li>
<li><strong>Summarize routes</strong> tại ABRs</li>
<li><strong>Enable authentication</strong> trong production</li>
<li><strong>Monitor OSPF neighbors</strong> thường xuyên</li>
<li><strong>Document area design</strong> rõ ràng</li>
</ol>
<h2 id="kết-luận">Kết luận</h2>
<p>OSPF là giao thức định tuyến mạnh mẽ và phổ biến trong doanh nghiệp. Việc hiểu rõ OSPF giúp bạn:</p>
<ul>
<li>Thiết kế mạng lớn hiệu quả</li>
<li>Troubleshoot routing issues</li>
<li>Tối ưu network convergence</li>
<li>Vượt qua CCNA/CCNP exams</li>
</ul>
<p>Trong bài tiếp theo, chúng ta sẽ học về <strong>Network Automation với Python</strong> - kỹ năng cần thiết cho kỷ nguyên DevNet!</p>
<h2 id="tài-liệu-tham-khảo">Tài liệu tham khảo</h2>
<ul>
<li>RFC 2328 - OSPF Version 2</li>
<li>Cisco OSPF Design Guide</li>
<li>CCNA Official Cert Guide - OSPF Chapter</li>
<li>Routing TCP/IP Volume 1 - Jeff Doyle</li>
</ul>
<hr>
<p><em>Practice makes perfect! Hãy thực hành trên Cisco Packet Tracer hoặc GNS3!</em></p>

  
  <div>
    <div>Tags:</div>
    <ul>
        <li><a href="/tags/ospf/">Ospf</a></li>
        <li><a href="/tags/routing/">Routing</a></li>
        <li><a href="/tags/dynamic-routing/">Dynamic-Routing</a></li>
        <li><a href="/tags/ccna/">Ccna</a></li>
        <li><a href="/tags/cisco/">Cisco</a></li>
    </ul>
  </div>


    </main>
    
    <p>Copyright 2025. All rights reserved.</p>

    
    <script>
        
        document.addEventListener('DOMContentLoaded', function() {
            const mobileMenuBtn = document.getElementById('mobile-menu-btn');
            const mobileMenu = document.getElementById('mobile-menu');
            
            if (mobileMenuBtn && mobileMenu) {
                mobileMenuBtn.addEventListener('click', function() {
                    mobileMenu.classList.toggle('hidden');
                });
            }
        });
    </script>
</body>
</html>
